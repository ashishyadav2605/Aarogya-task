(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{4887:(e,s,t)=>{Promise.resolve().then(t.bind(t,4510))},4510:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var r=t(5155),a=t(2115),l=t(6046),i=t(2110);function n(){let[e,s]=(0,a.useState)([]),[t,n]=(0,a.useState)(!0),[c,d]=(0,a.useState)(""),[o,x]=(0,a.useState)(null),[m,h]=(0,a.useState)("original"),[u,g]=(0,a.useState)(null),p=(0,l.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("token");if(!e){p.push("/admin/login");return}j(e)},[p]);let j=async e=>{try{let[t,r]=await Promise.all([fetch("http://localhost:5000/api/admin/users",{headers:{Authorization:"Bearer ".concat(e)}}),fetch("http://localhost:5000/api/admin/stats",{headers:{Authorization:"Bearer ".concat(e)}})]);if(!t.ok||!r.ok){if(403===t.status||403===r.status){localStorage.removeItem("token"),p.push("/admin/login"),i.oR.error("Session expired. Please log in again.");return}throw Error("Failed to fetch admin data")}let[a,l]=await Promise.all([t.json(),r.json()]);s(a.users.map(e=>{var s;return{...e,...(null===(s=l.users)||void 0===s?void 0:s.find(s=>s._id===e._id))||{}}}))}catch(e){d(e.message),i.oR.error(e.message)}finally{n(!1)}},b=(e,s)=>{navigator.clipboard.writeText(e),g(s),setTimeout(()=>g(null),2e3)},N=e=>{x(e)};return t?(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):c?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-md max-w-md w-full text-center",children:[(0,r.jsx)("div",{className:"text-red-500 mb-4",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsx)("p",{className:"text-gray-700 text-lg",children:c}),(0,r.jsx)("button",{onClick:()=>p.push("/"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Return Home"})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("button",{onClick:()=>p.push("/"),className:"flex items-center text-gray-600 hover:text-blue-600 transition-colors",children:[(0,r.jsx)("i",{className:"ri-arrow-left-line mr-1"}),"Back to Home"]}),(0,r.jsxs)("button",{onClick:()=>{localStorage.removeItem("token"),p.push("/admin/login"),i.oR.success("Logged out successfully")},className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[(0,r.jsx)("i",{className:"ri-logout-box-line mr-1"}),"Logout"]})]})]})})}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o?(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-100",children:[(0,r.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("button",{onClick:()=>{x(null)},className:"flex items-center text-gray-600 hover:text-blue-600 transition-colors mr-4",children:[(0,r.jsx)("i",{className:"ri-arrow-left-line mr-1"}),"Back to Users"]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Documents for ",o.email]})}),(0,r.jsxs)("div",{className:"inline-flex rounded-md shadow-sm",role:"group",children:[(0,r.jsxs)("button",{onClick:()=>h("original"),className:"px-4 py-2 text-sm font-medium rounded-l-lg border border-gray-200 ".concat("original"===m?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)("i",{className:"ri-file-text-line mr-2"}),"View Original"]}),(0,r.jsxs)("button",{onClick:()=>h("json"),className:"px-4 py-2 text-sm font-medium rounded-r-lg border border-gray-200 ".concat("json"===m?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)("i",{className:"ri-code-line mr-2"}),"View JSON"]})]})]}),o.documents&&o.documents.length>0?(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:o.documents.map((e,s)=>(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Document #",s+1]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Uploaded: ",new Date(e.timestamp).toLocaleString()]})]}),"json"===m&&(0,r.jsx)("button",{onClick:()=>b(JSON.stringify(e.jsonData,null,2),s),className:"p-2 text-gray-500 hover:text-gray-700 transition-colors",title:"Copy JSON",children:u===s?(0,r.jsx)("i",{className:"ri-check-line text-green-500"}):(0,r.jsx)("i",{className:"ri-file-copy-line"})})]}),"original"===m?(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("a",{href:"http://localhost:5000/".concat(e.path),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-blue-50 text-blue-600 rounded-md hover:bg-blue-100 transition-colors",children:[(0,r.jsx)("i",{className:"ri-eye-line mr-2"}),"View Document"]})}):(0,r.jsx)("div",{className:"mt-4 bg-gray-50 p-4 rounded-lg border border-gray-200 overflow-x-auto",children:(0,r.jsx)("pre",{className:"text-sm text-gray-800 font-mono",children:e.jsonData?(0,r.jsx)("code",{className:"whitespace-pre-wrap break-words",children:JSON.stringify(e.jsonData,null,2)}):"No JSON data available"})})]},s))}):(0,r.jsxs)("div",{className:"p-8 text-center",children:[(0,r.jsx)("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,r.jsx)("i",{className:"ri-folder-open-line text-3xl text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents found"}),(0,r.jsx)("p",{className:"text-gray-500",children:"This user hasn't uploaded any documents yet."})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Users"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:e.length})]}),(0,r.jsx)("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600",children:(0,r.jsx)("i",{className:"ri-user-line text-2xl"})})]})}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Documents"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:e.reduce((e,s)=>e+(s.documentCount||0),0)})]}),(0,r.jsx)("div",{className:"p-3 rounded-full bg-green-100 text-green-600",children:(0,r.jsx)("i",{className:"ri-file-text-line text-2xl"})})]})}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Recent Activity"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:e.filter(e=>new Date(e.lastActivity)>new Date(Date.now()-864e5)).length}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Active in last 24h"})]}),(0,r.jsx)("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600",children:(0,r.jsx)("i",{className:"ri-pulse-line text-2xl"})})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-100",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-100",children:(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Registered Users"})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Documents"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Active"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-user-line text-blue-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.email}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["Joined: ",new Date(e.createdAt).toLocaleDateString()]})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.documentCount||0})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.lastActivity?new Date(e.lastActivity).toLocaleString():"Never"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsx)("button",{onClick:()=>N(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"View Docs"})})]},e._id))})]})})]})]})}),(0,r.jsx)(i.N9,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}function c(){let e=(0,l.useRouter)(),[s,t]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{localStorage.getItem("token")?t(!0):e.push("/admin/login")},[e]),s)?(0,r.jsx)(n,{}):null}t(5716)}},e=>{var s=s=>e(e.s=s);e.O(0,[797,224,441,517,358],()=>s(4887)),_N_E=e.O()}]);